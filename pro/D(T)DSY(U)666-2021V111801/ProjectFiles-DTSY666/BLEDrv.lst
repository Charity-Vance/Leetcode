C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 1   


C51 COMPILER V9.54, COMPILATION OF MODULE BLEDRV
OBJECT MODULE PLACED IN .\BLEDrv.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Keil_v5 FMSH\C51\BIN\C51.EXE ..\SourceFiles\DRV\BLEDrv.c LARGE OBJECTADVANCE
                    -D OPTIMIZE(8,SPEED) BROWSE DEFINE(DTSY666) DEBUG SYMBOLS PRINT(.\BLEDrv.lst) OBJECT(.\BLEDrv.obj)

line level    source

   1          /*******************************************************************************************************
   2          **** Copyrightï¼š  (c)Copyright 2019,æµ™æ±Ÿæ­£æ³°ä»ªå™¨ä»ªè¡¨æœ‰é™è´£ä»»å…¬å¸,ç”µèƒ½è¡¨åº”ç”¨ç ”å‘     
             -                  
   3          ****                            All rights reserved.                                                 
   4          **** FileName:    BLEDrv.c                                                                          
   5          **** Brief:       è“ç‰™é©±åŠ¨æ–‡ä»¶ï¼Œæ¥å£ç»Ÿä¸€                                                       
             -             
   6          **** Author:      peter.he@chint.com                                                                 
   7          **** Version:     V1.0                                                                               
   8          **** Date:        2016-7-14                                                                          
   9          ****                                                                                                 
  10          **** note:ä¿®æ”¹å†å²è®°å½•åˆ—è¡¨ï¼Œæ¯æ¡ä¿®æ”¹è®°å½•åº”åŒ…æ‹¬ä¿®æ”¹æ—¥æœŸã€ä¿®æ”¹è€…                  
             -                        
  11          **** 1.  Author:                                                                                     
  12          ****     Version:                                                                                    
  13          ****     Date :                                                                                      
  14          **** 2.  Author:                                                                                     
  15          ****     Version:                                                                                       
  16          ****     Date:
  17          ****                                                                                        
  18          ****  addtogroup:Library                                                             
  19          **********************************************************************************************************
             -/
  20          
  21          /*--------------------------------- æ–‡ä»¶åŠŸèƒ½è¯´æ˜ ---------------------------------------------------
             -----*/
  22          /*
  23           *  è¯¥æ–‡ä»¶æ‰€æœ‰å‡½æ•°çš„å‰ç¼€ä¸ºxxxx_
  24           *  æ–‡ä»¶ä¸»å‡½æ•°å’Œå¯¹å¤–å‡½æ•°éœ€æ”¾åœ¨æ–‡ä»¶çš„é¦–éƒ¨ï¼Œå¹¶ä¸”ä¸»å‡½æ•°éœ€è¦æ”¾åœ¨ç¬¬ä¸€ä¸ªä½ç½®;
  25           *  å‡½æ•°æ³¨é‡Šé‡‡ç”¨æ ‡å‡†æ¨¡æ¿ï¼Œå‡½æ•°å†…éƒ¨æ³¨é‡Šé‡‡ç”¨//;
  26           *  å¯¹äºæ³¨é‡Šè¾ƒå¤šçš„éƒ¨åˆ†ï¼Œå¯ä»¥å¢åŠ ä¸€ä¸ªæ³¨é‡Šç¬¦ï¼Œç„¶åè¯¦ç»†è¯´æ˜æ”¾åœ¨æ–‡ä»¶çš„å°¾éƒ¨;
  27           *--------------------------------- æ–‡ä»¶åŠŸèƒ½è¯´æ˜ ---------------------------------------------------
             -----*/
  28           
  29          /**æœ‰å½¢å‚çš„å‡½æ•°æ ¼å¼:*/
  30          /*------------------------------------------------------------------------------------------------------*/
  31          /**
  32           *  @brief    xxä»»åŠ¡å¤„ç†å‡½æ•°
  33           *
  34           *  @param    xx :
  35           *
  36           *  @return   xx
  37           *
  38           *  @note     xx
  39           *
  40           */
  41          /*------------------------------------------------------------------------------------------------------*/
  42          /**æ— å½¢å‚çš„å‡½æ•°æ ¼å¼:*/
  43          /*------------------------------------------------------------------------------------------------------*/
  44          /**
  45           *  @brief    ä¸Šç”µæ‰€æœ‰å£çº¿é…ç½®æˆåˆå§‹çŠ¶æ€ï¼Œåé¢å¯æ ¹æ®éœ€è¦å¼€å¯å’Œé…ç½®
  46           *
  47           *  @return   xx
  48           *
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 2   

  49           *  @note     xx
  50           *
  51           */
  52          /*------------------------------------------------------------------------------------------------------*/
  53           
  54           
  55          /*----------------< åŒ…å«æ–‡ä»¶ >----------------------------------*/
  56          #include "..\SourceFiles\PUB\Include.h"
  57          
  58          /*----------------< å®å®šä¹‰åŒº >----------------------------------*/
  59          #define BLE_MODUL_FACTORY       BLE_MODUL_FACTORY_SW
  60          #define BLE_MODUL_FACTORY_SW     1
  61          #define BLE_MODUL_FACTORY_BX     2
  62          
  63          #define RXBUF_LEN       100             // è“ç‰™å‘é€æ¥æ”¶ç¼“å†²åŒºçš„æœ€å¤§é•¿åº¦
  64          
  65          /*----------------< å¸¸é‡å®šä¹‰ >----------------------------------*/ 
  66          
  67          /*----------------< å˜é‡å®šä¹‰ >----------------------------------*/ 
  68          typedef struct 
  69          {
  70                  uchar8          ucIndex;                /*ç´¢å¼•*/
  71                  ulong32         ucaDataId;              /*æ•°æ®æ ‡è¯†*/
  72                  uchar8          IsWrite;                /*æ˜¯å¦å¯å†™*/
  73                  uchar8          ucaDataLen;             /*æ•°æ®é•¿åº¦*/
  74          }Str_BleData_MAP;
  75          
  76          uchar8 code C_cBlePayload_Head[] = {0x02,0x01,0x06, 0x0B,0xFF, 0xF0,0xFF, 0x01, 0x43,0x48,0x49,0x4e,0x54,0
             -x49,0x4d, 0x0F,0x09, 0x4b,0x4c };     /*å¹¿æ’­æ•°æ®çš„å‰ç¼€ï¼Œæ•°æ®å†…å®¹å›ºå®š*/
  77                  #define C_cBlePayload_Head_Len  sizeof(C_cBlePayload_Head)
  78          
  79          Str_BleData_MAP code C_StrBle_MAP_TAB[ ]={              /*è¿™å‡ é¡¹æ•°æ®ä¸èƒ½åˆ é™¤ï¼Œéœ€è¦å¢åŠ çš„æ•°æ®é¡¹æ”¾åœ¨
             -æœ€åé¢*/
  80                  /*ç´¢å¼•                                        æ•°æ®æ ‡è¯†         æ˜¯å¦å¯å†™    é•¿åº¦*/
  81                  { COMM_BLE_MAC  ,       0x01000001      ,       _TRUE   ,       21      , },    /*æœ¬è®¾å¤‡Macåœ°å€+è®¾å¤‡åç§°+æœ¬è®¾å¤‡é…å¯¹ç (3å­—èŠ
             -‚hex) 6+12+3 */
  82                  { COMM_BLE_TPL  ,       0x01000006      ,       _TRUE   ,       1       , },    /*ä¿®æ”¹å‘å°„åŠŸç‡ 00è¡¨ç¤º0db(ä¸å¯è®¾);01è¡¨ç¤º-2db;02è
             -¡¨ç¤º-4db;03è¡¨ç¤º-10db;04è¡¨ç¤º-20db;05è¡¨ç¤º2db;06è¡¨ç¤º3db(é»˜è®¤);*/
  83                  //{ 0x01000007  ,       _TRUE   ,       1       , },    /*è®¾ç½®SMPç­‰çº§00ï¼šä¸å¯ç”¨é…å¯¹ï¼ˆé»˜è®¤ï¼‰01ï¼šJUST WORK02ï¼šMITM_
             -KEY(æœ‰è¾“å…¥èƒ½åŠ›)03ï¼šMITM_DISPLAYï¼ˆæœ‰æ˜¾ç¤ºèƒ½åŠ›ï¼‰*/
  84                  { COMM_BLE_EADV ,       0x0100010A      ,       _TRUE   ,       31      , },    /*å¹¿æ’­åŒ…1å¹¿æ’­å†…å®¹ï¼ˆä¸»å¹¿æ’­ï¼‰ï¼ˆè®¾ç½®MACåœ°å€å
             -’Œå¹¿æ’­å†…å®¹åæ‰å¼€å§‹å¹¿æ’­ï¼‰*/
  85                  { COMM_BLE_MOD  ,       0x0100000B      ,       _TRUE   ,       1       , },    /*è®¾ç½®è“ç‰™å·¥ä½œæ¨¡å¼ 01ï¼šä»ï¼ˆä»…åšä»ï¼‰*/
  86                  { COMM_BLE_TTP  ,       0x0100000D      ,       _TRUE   ,       1       , },    /*é€ä¼ åè®®ï¼ˆè¦æ±‚é€ä¼ æ•°æ®éœ€è¦ç¬¦åˆåè®®è¦æ±‚ï
             -¼Œå¯ä»¥ä¸åˆ¤æ–­æ•°æ®æ˜¯å¦åˆæ³•ï¼Œä½†å¿…é¡»ç¬¦åˆæ•°æ®å¸§æ ¼å¼è¦æ±‚ï¼Œè¦æ±‚å‘èµ·é€ä¼ æ—¶æ•´å¸§æ•°æ®å·²ç»æ”¶å
             -…¨ï¼Œä¸€æ¬¡ä¸‹å‘ï¼‰01ï¼š645åè®®ï¼ˆé»˜è®¤ï¼‰02ï¼š698åè®®*/
  87                  { COMM_BLE_STAT ,       0x00000002      ,       _FALSE  ,       6       , },    /*è¯»å–å½“å‰è¿æ¥çš„è®¾å¤‡MACï¼ˆå¦‚æœæ²¡æœ‰è¿æ¥ï¼Œè¿
             -”å›å…¨FFï¼‰*/
  88                  { COMM_BLE_MFV  ,       0x00000003      ,       _FALSE  ,       32      , },    /*æ¨¡å—å›ºä»¶ç‰ˆæœ¬å·ASCII*/
  89          };
  90          #define MAX_C_StrBle_MAP_TAB    sizeof(C_StrBle_MAP_TAB)/sizeof(Str_BleData_MAP)
  91          
  92          /*----------------< å‡½æ•°å£°æ˜ >----------------------------------*/
  93          
  94          static uchar8 BleDrv_BleComm(uchar8 v_ucOptIndex, uchar8 C_cBleCmd, uchar8 *p_ucDataBuff);
  95          static uchar8 BleDrv_GetBlePara( uchar8 V_ucCmdIndex, uchar8 *p_ucDataBuf, uchar8 v_ucLen );
  96          static uchar8 BleDrv_SetBlePara( uchar8 V_ucCmdIndex, uchar8 *p_ucDataBuf, uchar8 v_ucLen );
  97          
  98          void BleDrv_SetBleRunPara( void );
  99          void BleDrv_InitBleRunPara( void );
 100          
 101          void BleDrv_WakeUpBle( uchar8 v_ucTRMode );
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 3   

 102          void BleDrv_InitPwn(void);
 103          
 104          uchar8 BleDrv_GetBleStat(void);
 105          uchar8 BleDrv_GetBleADVP(uchar8 *p_ucDataBuf);
 106          uchar8 BleDrv_GetBleKey(uchar8 *p_ucDataBuf);
 107          uchar8 BleDrv_GetBleMac(uchar8 *p_ucDataBuf);
 108          uchar8 BleDrv_GetBleName(uchar8 *p_ucDataBuf);
 109          uchar8 BleDrv_GetBlePSK( uchar8 *p_ucDataBuf );
 110          uchar8 BleDrv_GetBleSMPLv(uchar8 *p_ucDataBuf);
 111          
 112          uchar8 BleDrv_SetBleStat(void);
 113          uchar8 BleDrv_SetBleADVP(uchar8 *p_ucDataBuf);
 114          uchar8 BleDrv_SetBleCLRBond( uchar8 *p_ucDataBuf );
 115          uchar8 BleDrv_SetBleKey(uchar8 *p_ucDataBuf);
 116          uchar8 BleDrv_SetBleMac(uchar8 *p_ucDataBuf);
 117          //uchar8 BleDrv_SetBleName(uchar8 *p_ucDataBuf);
 118          uchar8 BleDrv_SetBlePSK(uchar8 *p_ucDataBuf);
 119          uchar8 BleDrv_SetBleSMPLv(uchar8 *p_ucDataBuf);
 120          uchar8 BleDrv_SetBleTPL(uchar8 *p_ucDataBuf);
 121          //uchar8 BleDrv_GetOneByteFromUart( uchar8 *p_ucDatabuf );
 122          //uchar8 BleDrv_SetOneByteToUart( uchar8 v_ucDataBuff ); 
 123          uchar8 BleDrv_CommSetBlePara(uchar8 v_ucComIndex, uchar8 v_ucLen, uchar8 *p_ucDataBuf);
 124          uchar8 BleDrv_CommGetBlePara(uchar8 v_ucComIndex, uchar8 v_ucLen, uchar8 *p_ucDataBuf);
 125          uchar8 BleDrv_BleParaChk(uchar8 v_ucMode);
 126          void BleDrv_BleStatuChk(void);
 127          uchar8 BleDrv_GetBleUartSta(void);
 128          void BleDrv_BleReset(void);
 129          
 130          /*----------------< å‡½æ•°å®šä¹‰ >----------------------------------*/
 131          
 132          /*------------------------------------------------------------------------------------------------------*/
 133          /**
 134           *  @brief    è®¾ç½®è“ç‰™å‚æ•°
 135           *
 136           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„åç§°é¦–åœ°å€
 137           *                        v_ucLen :éœ€è¦è®¾ç½®çš„æ•°æ®çš„é•¿åº¦
 138           *  @return   
 139           *
 140           *  @note     xx
 141           *
 142           */
 143          /*------------------------------------------------------------------------------------------------------*/
 144          uchar8 BleDrv_SetBlePara( uchar8 V_ucCmdIndex, uchar8 *p_ucDataBuf, uchar8 v_ucLen )
 145          { 
 146   1              uchar8 V_ucTempBuff[RXBUF_LEN]="";
 147   1              uchar8 *P_ucDataEcho=V_ucTempBuff;      
 148   1              uchar8 V_ucResult=_FAILED;
 149   1              
 150   1              if( v_ucLen )
 151   1              {
 152   2                      LibPub_MemCopyBytes( p_ucDataBuf, V_ucTempBuff, v_ucLen ); 
 153   2              }
 154   1              
 155   1              if( _SUCCESS == BleDrv_BleComm( V_ucCmdIndex, BLE_RW_WRITE, V_ucTempBuff ) )
 156   1              {
 157   2                      V_ucResult =  _SUCCESS ;
 158   2              }
 159   1              
 160   1              return ( V_ucResult );
 161   1      }
 162          /*------------------------------------------------------------------------------------------------------*/
 163          /**
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 4   

 164           *  @brief    è¯»è“ç‰™å‚æ•°
 165           *
 166           *  @param    p_ucDataBuf :è¦è·å–çš„Macçš„é¦–åœ°å€
 167           *            v_ucLen ï¼šè¯»å–æ•°æ®çš„é•¿åº¦
 168           *  @return   
 169           *
 170           *  @note      
 171           *
 172           */
 173          /*------------------------------------------------------------------------------------------------------*/
 174          uchar8 BleDrv_GetBlePara( uchar8 V_ucCmdIndex, uchar8 *p_ucDataBuf, uchar8 v_ucLen )
 175          { 
 176   1              uchar8 V_ucTempBuff[RXBUF_LEN]=""; 
 177   1              uchar8 V_ucResult=_FAILED; 
 178   1              
 179   1              if( _SUCCESS == BleDrv_BleComm( V_ucCmdIndex, BLE_RW_READ, V_ucTempBuff ) )     /*è¯»æ•°æ®ï¼ŒæŒ‰ç…§ç´¢å¼•æ‰¾
             -*/
 180   1              {
 181   2                      LibPub_MemCopyBytes( V_ucTempBuff, p_ucDataBuf, v_ucLen );      /*æ•°æ®æ ‡è¯†ä¸åå›*/
 182   2                      V_ucResult = _SUCCESS;
 183   2              }               
 184   1              
 185   1              return V_ucResult;
 186   1      }
 187          
 188          /*------------------------------------------------------------------------------------------------------*/
 189          /**
 190           *  @brief    è·å–è“ç‰™çŠ¶æ€
 191           *
 192           *  @return   è“ç‰™çŠ¶æ€ï¼Œå…·ä½“è§å¤´æ–‡ä»¶ä¸­çš„å®å®šä¹‰
 193           *
 194           *  @note     xx
 195          /*------------------------------------------------------------------------------------------------------*/
 196          uchar8 BleDrv_GetBleStat( void )
 197          {       
 198   1              return GStr_Flag.ucBLESTATFlag;
 199   1      }
 200          
 201          /*------------------------------------------------------------------------------------------------------*/
 202          /**
 203           *  @brief    è®¾ç½®è“ç‰™å·¥ä½œæ¨¡å¼ï¼Œèµ·åŠ¨å¹¿æ’­ï¼Œèµ·åŠ¨æ‰«æç­‰
 204           *
 205           *  @param    xx :
 206           *
 207           *  @return   
 208           *
 209           *  @note     xx
 210           *
 211           */
 212          /*------------------------------------------------------------------------------------------------------*/
 213          uchar8 BleDrv_SetBleStat( void )
 214          { 
 215   1              uchar8 V_ucTempBuff[40]="";
 216   1              uchar8 V_ucResult = _FAILED;
 217   1              
 218   1              LibPub_MemCopyBytes( &C_cBlePayload_Head[0], &V_ucTempBuff[0], C_cBlePayload_Head_Len );        
 219   1              LibPub_HEXtoAscii( &GStr_MeterIFO.ucaCommAddr[0], &V_ucTempBuff[C_cBlePayload_Head_Len], 6 );   
 220   1              
 221   1              if( _SUCCESS == BleDrv_BleComm( COMM_BLE_EADV, BLE_RW_WRITE, V_ucTempBuff ) )
 222   1              {
 223   2                      V_ucResult =  _SUCCESS ;
 224   2                      GStr_Flag.ucBLESTATFlag = BLE_STAT_ADV_ON;              /* è“ç‰™çŠ¶æ€è®¾ç½®ä¸ºå¯åŠ¨å¹¿æ’­ */
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 5   

 225   2                      GStr_Monitor.ucBleAdvCnt = 0;                                   /* è“ç‰™å¹¿æ’­è®¡æ—¶å™¨æ¸…é›¶ */
 226   2              }
 227   1              return ( V_ucResult );
 228   1      }
 229          
 230          /*------------------------------------------------------------------------------------------------------*/
 231          /**
 232           *  @brief    è®¾ç½®è“ç‰™Mac
 233           *
 234           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„Macé¦–åœ°å€
 235           *
 236           *  @return   
 237           *
 238           *  @note     xx
 239           *
 240           */
 241          /*------------------------------------------------------------------------------------------------------*/
 242          uchar8 BleDrv_SetBleMac(uchar8 *p_ucDataBuf)
 243          {  
 244   1              return( BleDrv_SetBlePara( COMM_BLE_MAC, p_ucDataBuf, BLE_MAC_Len ) );  /*æ–°æ¨¡å—æœ‰åç§°ï¼Œ4+6+3+12*/       
 245   1      }
 246          /*------------------------------------------------------------------------------------------------------*/
 247          /**
 248           *  @brief    è·å–è“ç‰™Mac
 249           *
 250           *  @param    p_ucDataBuf :è¦è·å–çš„Macçš„é¦–åœ°å€
 251           *
 252           *  @return   
 253           *
 254           *  @note     
 255           *
 256           */
 257          /*------------------------------------------------------------------------------------------------------*/
 258          uchar8 BleDrv_GetBleMac(uchar8 *p_ucDataBuf)
 259          {  
 260   1              return( BleDrv_GetBlePara( COMM_BLE_MAC, p_ucDataBuf, BLE_MAC_Len ) );
 261   1      }
 262          /*------------------------------------------------------------------------------------------------------*/
 263          /**
 264           *  @brief    è®¾ç½®è“ç‰™é…å¯¹ç 
 265           *
 266           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„keyé¦–åœ°å€
 267           *
 268           *  @return   
 269           *
 270           *  @note     xx
 271           *
 272           */
 273          /*------------------------------------------------------------------------------------------------------*/
 274          //uchar8 BleDrv_SetBleKey(uchar8 *p_ucDataBuf)
 275          //{  
 276          //      return( BleDrv_SetBlePara( BLE_AT_SET_PSK, p_ucDataBuf, 6 ) );
 277          //}
 278          /*------------------------------------------------------------------------------------------------------*/
 279          /**
 280           *  @brief    è·å–è“ç‰™key
 281           *
 282           *  @param    p_ucDataBuf :è¦è·å–çš„Macçš„é¦–åœ°å€
 283           *
 284           *  @return   
 285           *
 286           *  @note      
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 6   

 287           *
 288           */
 289          /*------------------------------------------------------------------------------------------------------*/
 290          //uchar8 BleDrv_GetBleKey(uchar8 *p_ucDataBuf)
 291          //{  
 292          //      return( BleDrv_GetBlePara( BLE_AT_GET_PSK, p_ucDataBuf, 6 ) );
 293          //}
 294          /*------------------------------------------------------------------------------------------------------*/
 295          /**
 296           *  @brief    è®¾ç½®è“ç‰™åç§°
 297           *
 298           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„åç§°é¦–åœ°å€
 299           *
 300           *  @return   
 301           *
 302           *  @note     xx
 303           *
 304           */
 305          /*------------------------------------------------------------------------------------------------------*/
 306          //uchar8 BleDrv_SetBleName(uchar8 *p_ucDataBuf)
 307          //{  
 308          //      return( BleDrv_SetBlePara(  0x01000001, 13, 01, p_ucDataBuf ) );///*è®¾ç½®è“ç‰™åç§°ï¼Œæ–°åè®®ä¸èƒ
             -½è®¾ç½®*///
 309          //}
 310          /*------------------------------------------------------------------------------------------------------*/
 311          /**
 312           *  @brief    è·å–è“ç‰™åç§°
 313           *
 314           *  @param    p_ucDataBuf :è¦è·å–çš„åç§°çš„é¦–åœ°å€
 315           *
 316           *  @return   
 317           *
 318           *  @note      
 319           *
 320           */
 321          /*------------------------------------------------------------------------------------------------------*/
 322          uchar8 BleDrv_GetBleName(uchar8 *p_ucDataBuf)
 323          {  
 324   1              uchar8 V_ucReasult = _FAILED;
 325   1              uchar8 V_ucTempBuff[25] = "";
 326   1      
 327   1              V_ucReasult = BleDrv_GetBlePara( COMM_BLE_MAC, V_ucTempBuff, BLE_MAC_Len );
 328   1      
 329   1              if( _SUCCESS == V_ucReasult )
 330   1              {
 331   2                      LibPub_MemCopyBytes(&V_ucTempBuff[6], &p_ucDataBuf[0], 12);     /*mac+åç§°+é…å¯¹ç ï¼›6+12+3*/
 332   2              }       
 333   1              return( V_ucReasult );
 334   1      }
 335          
 336          /*------------------------------------------------------------------------------------------------------*/
 337          /**
 338           *  @brief    è®¾ç½®é…å¯¹ç­‰çº§
 339           *
 340           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„åç§°é¦–åœ°å€
 341           *
 342           *  @return   
 343           *
 344           *  @note     xx
 345           *
 346           */
 347          /*------------------------------------------------------------------------------------------------------*/
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 7   

 348          //uchar8 BleDrv_SetBleSMPLv(uchar8 *p_ucDataBuf)
 349          //{  
 350          //      return( BleDrv_SetBlePara( BLE_AT_SET_SMPLV, p_ucDataBuf, 1 ) );
 351          //}
 352          /*------------------------------------------------------------------------------------------------------*/
 353          /**
 354           *  @brief    è·å–é…å¯¹ç­‰çº§
 355           *
 356           *  @param    p_ucDataBuf :è¦è·å–çš„æ•°æ®çš„é¦–åœ°å€
 357           *
 358           *  @return   
 359           *
 360           *  @note      
 361           *
 362           */
 363          /*------------------------------------------------------------------------------------------------------*/
 364          //uchar8 BleDrv_GetBleSMPLv(uchar8 *p_ucDataBuf)
 365          //{  
 366          //      return( BleDrv_GetBlePara( BLE_AT_GET_SMPLV, p_ucDataBuf, 1 ) );
 367          //}
 368          
 369          /*------------------------------------------------------------------------------------------------------*/
 370          /**
 371           *  @brief    è®¾ç½®è“ç‰™å¹¿æ’­å‘¨æœŸ
 372           *
 373           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„å‚æ•°é¦–åœ°å€
 374           *
 375           *  @return   
 376           *
 377           *  @note     å‘ä¸²å£  RX è¾“å…¥ä»¥ä¸‹å­—ç¬¦ä¸²"TTM:ADP-%s "ï¼Œ%s  æ ¼å¼ä¸º%dmsï¼Œä¹Ÿå¯ä»¥è®¾ç½®æ¨¡å—
             -çš„å¹¿æ’­å‘¨æœŸï¼Œ
 378                        å¦‚"TTM:ADP-20ms",è®¾ç½®å¹¿æ’­å‘¨æœŸä¸º 20msï¼Œå–å€¼èŒƒå›´ä¸º 20ms~10000msã€‚
 379           *
 380           */
 381          /*------------------------------------------------------------------------------------------------------*/
 382          //uchar8 BleDrv_SetBleADVP(uchar8 *p_ucDataBuf)
 383          //{  
 384          //      uchar8 V_ucLen ;
 385          //      V_ucLen = strlen(p_ucDataBuf);
 386          //      return( BleDrv_SetBlePara( BLE_AT_SET_ADP, p_ucDataBuf, V_ucLen ) );
 387          //}
 388          
 389          /*------------------------------------------------------------------------------------------------------*/
 390          /**
 391           *  @brief    è·å–è“ç‰™å¹¿æ’­å‘¨æœŸ
 392           *
 393           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„å‚æ•°é¦–åœ°å€
 394           *
 395           *  @return   
 396           *
 397           *  @note     å‘ä¸²å£  RX è¾“å…¥ä»¥ä¸‹å­—ç¬¦ä¸²"TTM:ADP-?"æŸ¥è¯¢å½“å‰çš„å¹¿æ’­å‘¨æœŸï¼Œ æ¨¡ç»„è¿”å›"TT
             -M:ADP-%s\r\n\0"ï¼Œ%s 
 398          ä¸ºå­—ç¬¦ä¸²è¡¨ç¤ºå½“å‰å¹¿æ’­é—´éš”ï¼Œå¦‚"TTM:ADP-200ms\r\n\0"è¡¨ç¤ºå½“å‰å¹¿æ’­é—´éš”ä¸º 200ms
 399           *
 400           */
 401          /*------------------------------------------------------------------------------------------------------*/
 402          //uchar8 BleDrv_GetBleADVP(uchar8 *p_ucDataBuf)
 403          //{
 404          //      uchar8 V_ucReasult,V_ucCnti;
 405          //      uchar8 V_ucTempBuff[5]="";
 406          //      
 407          //      V_ucReasult = BleDrv_GetBlePara( BLE_AT_GET_ADP, V_ucTempBuff, 5 ) ;
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 8   

 408          //      if( _SUCCESS == V_ucReasult  )
 409          //      {
 410          //              for( V_ucCnti = 0; V_ucCnti<5; V_ucCnti++ )
 411          //              {
 412          //                      if( (V_ucTempBuff[V_ucCnti]>=0x30)&&(V_ucTempBuff[V_ucCnti]<=0x39) )
 413          //                      {
 414          //                              p_ucDataBuf[V_ucCnti] = V_ucTempBuff[V_ucCnti];
 415          //                      }
 416          //              }
 417          //      }
 418          //      return( V_ucReasult );
 419          //}
 420          
 421          
 422          /*------------------------------------------------------------------------------------------------------*/
 423          /**
 424           *  @brief    è®¾ç½®è“ç‰™å‘å°„åŠŸç‡
 425           *
 426           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„å‚æ•°é¦–åœ°å€,æœ€å¤§3å­—èŠ‚ï¼Œå¦åˆ™è¿”å›é”™è¯¯
 427           *
 428           *  @return   
 429           *
 430           *  @note     æ•°æ®ä¸ºASCII:-20,-8,-4,0,+2ç­‰ TTM:TPL-(X)
 431           *
 432           */
 433          /*------------------------------------------------------------------------------------------------------*/
 434          uchar8 BleDrv_SetBleTPL( uchar8 *p_ucDataBuf )
 435          {
 436   1              uchar8  V_ucLen = BLE_TPL_Len;
 437   1              uchar8 V_ucTempBuff[5] = "";
 438   1      
 439   1              LibPub_MemCopyBytes( p_ucDataBuf, &V_ucTempBuff[0], V_ucLen );
 440   1              return( BleDrv_SetBlePara( COMM_BLE_TPL, V_ucTempBuff, BLE_TPL_Len ) );
 441   1      }
 442          
 443          /*------------------------------------------------------------------------------------------------------*/
 444          /**
 445           *  @brief    é€šä¿¡è®¾ç½®è“ç‰™æ¨¡å—å‚æ•°
 446           *
 447           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„å‚æ•°é¦–åœ°å€,æœ€å¤§3å­—èŠ‚ï¼Œå¦åˆ™è¿”å›é”™è¯¯
 448           *            v_ucComIndex ï¼šè¦è®¾ç½®çš„å‚æ•°å…ƒç´ ç´¢å¼•
 449           *  @return   
 450           *
 451           *  @note     
 452           *
 453           */
 454          /*------------------------------------------------------------------------------------------------------*/
 455          
 456          uchar8 BleDrv_CommSetBlePara(uchar8 v_ucComIndex, uchar8 v_ucLen, uchar8 *p_ucDataBuf)
 457          {
 458   1              uchar8 V_ucTempBuff[35] = "";
 459   1      
 460   1              LibPub_MemCopyBytes( p_ucDataBuf, &V_ucTempBuff[0], v_ucLen );
 461   1      
 462   1              return( BleDrv_SetBlePara( v_ucComIndex, V_ucTempBuff, v_ucLen ) );
 463   1      }
 464          
 465          /*------------------------------------------------------------------------------------------------------*/
 466          /**
 467           *  @brief    é€šä¿¡è¯»è“ç‰™æ¨¡å—å‚æ•°
 468           *
 469           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„å‚æ•°é¦–åœ°å€,æœ€å¤§3å­—èŠ‚ï¼Œå¦åˆ™è¿”å›é”™è¯¯
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 9   

 470           *            v_ucComIndex ï¼šè¦è®¾ç½®çš„å‚æ•°å…ƒç´ ç´¢å¼•
 471           *  @return   
 472           *
 473           *  @note     
 474           *
 475           */
 476          /*------------------------------------------------------------------------------------------------------*/
 477          
 478          uchar8 BleDrv_CommGetBlePara( uchar8 v_ucComIndex, uchar8 v_ucLen, uchar8 *p_ucDataBuf )
 479          {
 480   1              return( BleDrv_GetBlePara( v_ucComIndex, p_ucDataBuf, v_ucLen ) );
 481   1      }
 482          
 483          /*------------------------------------------------------------------------------------------------------*/
 484          /**
 485           *  @brief    è·å–è“ç‰™å‘å°„åŠŸç‡
 486           *
 487           *  @param    p_ucDataBuf :è¦è·å–çš„å‚æ•°çš„é¦–åœ°å€ï¼Œæœ€å¤§5å­—èŠ‚
 488           *
 489           *  @return   
 490           *
 491           *  @note      
 492           *
 493           */
 494          /*------------------------------------------------------------------------------------------------------*/
 495          uchar8 BleDrv_GetBleTPL(uchar8 *p_ucDataBuf)
 496          {  
 497   1              return( BleDrv_GetBlePara( COMM_BLE_TPL, p_ucDataBuf, BLE_TPL_Len ));
 498   1      }
 499          /*------------------------------------------------------------------------------------------------------*/
 500          /**
 501           *  @brief    æ¸…é™¤ç»‘å®šä¿¡æ¯
 502           *
 503           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„å‚æ•°é¦–åœ°å€,è¿™ä¸ªå‘½ä»¤æ²¡æœ‰æ•°æ®ï¼Œæ‰€ä»¥é•¿åº¦å¯ä»¥å†™æˆ
             -0
 504           *
 505           *  @return   
 506           *
 507           *  @note     æ¸…é™¤é…å¯¹ç»‘å®šçš„ä¿¡æ¯
 508           *
 509           */
 510          /*------------------------------------------------------------------------------------------------------*/
 511          //uchar8 BleDrv_SetBleCLRBond( uchar8 *p_ucDataBuf )
 512          //{ 
 513          //      return( BleDrv_SetBlePara( BLE_AT_CLR_BOND, p_ucDataBuf, 0 ) ); 
 514          //}
 515          /*------------------------------------------------------------------------------------------------------*/
 516          /**
 517           *  @brief    è®¾ç½®é…å¯¹å¯†ç 
 518           *
 519           *  @param    p_ucDataBuf :è¦è®¾ç½®çš„å‚æ•°é¦–åœ°å€ï¼Œ6å­—èŠ‚ASCII
 520           *
 521           *  @return   
 522           *
 523           *  @note     é…å¯¹å¯†ç 
 524           *
 525           */
 526          /*------------------------------------------------------------------------------------------------------*/
 527          //uchar8 BleDrv_SetBlePSK( uchar8 *p_ucDataBuf )
 528          //{ 
 529          //      return( BleDrv_SetBlePara( BLE_AT_SET_PSK, p_ucDataBuf, 6 ) ); 
 530          //}
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 10  

 531          /*------------------------------------------------------------------------------------------------------*/
 532          /**
 533           *  @brief    è·å–é…å¯¹å¯†ç 
 534           *
 535           *  @param    p_ucDataBuf :è¦è·å–çš„å‚æ•°é¦–åœ°å€ï¼Œ6å­—èŠ‚ASCII
 536           *
 537           *  @return   
 538           *
 539           *  @note     é…å¯¹å¯†ç 
 540           *
 541           */
 542          /*------------------------------------------------------------------------------------------------------*/
 543          //uchar8 BleDrv_GetBlePSK( uchar8 *p_ucDataBuf )
 544          //{ 
 545          //      return( BleDrv_SetBlePara( BLE_AT_GET_PSK, p_ucDataBuf, 6 ) ); 
 546          //}
 547          /*------------------------------------------------------------------------------------------------------*/
 548          /**
 549           *  @brief    ä¸Šç”µé…ç½®è“ç‰™é€šä¿¡å‚æ•°ï¼Œä¸Šç”µä¸ç®¡ä¸²å£æ˜¯å¦ç©ºé—²ï¼Œå‡é…ç½®ï¼Œå¦‚æœæ˜¯å¹³æ—
             -¶æ£€æŸ¥ï¼Œè¦åˆ¤æ–­å½“å‰ä¸²å£çŠ¶æ€ï¼Œå¦‚æœç©ºé—²æ‰æ“ä½œï¼Œå¦åˆ™ä¸æ“ä½œ
 550           *
 551           *  @return   xx
 552           *
 553           *  @note     1. å…ˆåˆ¤å®šæ˜¯å¦ä¸ºå¹¿æ’­çŠ¶æ€ï¼Œä¸æ˜¯åˆ™è®¾ç½®æˆå¹¿æ’­çŠ¶æ€
 554           *  @note     2.æ ¡éªŒä¸€ä¸‹Macå‚æ•°ï¼Œå¦å¤–å°†æ›´æ–°Macå’Œåç§°
 555           *  @note     3.æ›´æ–°é…å¯¹ç ç­‰å‚æ•°
 556          
 557           *
 558           */
 559          /*------------------------------------------------------------------------------------------------------*/
 560          void BleDrv_InitPwn(void)
 561          {       
 562   1                      
 563   1              /*--------------------------------------------------------------------------*/
 564   1              // æ ¡éªŒä¸€ä¸‹Macã€é…å¯¹ç ã€å¹¿æ’­å‘¨æœŸå’Œåç§°  
 565   1              BleDrv_BleParaChk(INT_Mode);
 566   1              
 567   1              /*--------------------------------------------------------------------------*/
 568   1      //      // ä¸Šç”µç›´æ¥å†™è¿è¡Œå‚æ•°ï¼Œè¿è¡Œå‚æ•°éœ€è¦1åˆ†é’Ÿæ£€æµ‹ä¸€æ¬¡
 569   1              BleDrv_SetBleRunPara();
 570   1              
 571   1      //      /*--------------------------------------------------------------------------*/
 572   1      //      // åˆ¤æ–­ä¸€ä¸‹å¦‚æœä¸æ˜¯è¿æ¥çŠ¶æ€ï¼Œå¼€å¯å¹¿æ’­çŠ¶æ€
 573   1              BleDrv_BleStatuChk();
 574   1      //      
 575   1      }
 576          
 577          /*------------------------------------------------------------------------------------------------------*/
 578          /**
 579           *  @brief    å®šæ—¶æ£€æŸ¥è“ç‰™å‚æ•°ï¼Œ1åˆ†é’Ÿä¸€æ¬¡
 580           *
 581          *  @return   _SUCCESS å¤„ç†æˆåŠŸ; _FAILED å¤„ç†å¤±è´¥ï¼Œä¼šåˆå§‹åŒ–è“ç‰™æ¨¡ç»„å‚æ•°
 582           *
 583           *  @note     
 584           *
 585           */
 586          /*------------------------------------------------------------------------------------------------------*/
 587          uchar8 BleDrv_BleParaChk(uchar8 v_ucMode)
 588          {
 589   1              uchar8 V_ucResult = _SUCCESS;
 590   1              //uchar8 p_ucDataBuff[20];
 591   1              
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 11  

 592   1              /* å…ˆæ£€æŸ¥ä¸€ä¸‹RAMï¼Œå¦‚æœcrcå‡ºé”™ï¼Œå°±ä»E2ä¸­æ¢å¤ä¸€ä¸‹ï¼Œç„¶åä¸ç®¡æ˜¯å¦æ­£ç¡®éƒ½é‡æ–°åˆå
             -§‹åŒ–ä¸€ä¸‹è“ç‰™æ¨¡ç»„å‚æ•° */
 593   1              ///ä¸Šç”µç›´æ¥å†™MACï¼Œä¸åˆ¤MACæ˜¯å¦æ­£ç¡®
 594   1      
 595   1              if (( _TRUE != LibPub_CrcCheck( (uchar8*)&GStr_BLEGroup.ucBleMAC[0], GStr_BLE_GROUP_TypeLEN-2, GStr_BLEGr
             -oup.usCRC16 ) )
 596   1                      ||(v_ucMode==INT_Mode))
 597   1              {
 598   2                      if( _FAILED == LibPub_ReadDataFromE2prom( LIB_E2P_BLE_PARA, 0, (uchar8*)&GStr_BLEGroup.ucBleMAC[0] ) )
 599   2                      {  
 600   3                              V_ucResult = _FAILED;
 601   3                      }
 602   2                              
 603   2                      /* å¦‚æœRAMå‚æ•°æœ‰å˜åŒ–ï¼Œä»E2æ¢å¤ä»¥åä¹Ÿé‡æ–°è®¾ç½®ä¸€ä¸‹è“ç‰™å‚æ•°ï¼Œè®¾ç½®æˆå¹¿æ’­æ€ */
 604   2                      BleDrv_BleReset();
 605   2                      BleDrv_InitBleRunPara();
 606   2                      BleDrv_SetBleStat();     
 607   2              }
 608   1               
 609   1              return V_ucResult; 
 610   1      }
 611          
 612          
 613          /*------------------------------------------------------------------------------------------------------*/
 614          /**
 615           *  @brief    å®šæ—¶æ£€æŸ¥è“ç‰™çŠ¶æ€ï¼Œæš‚å®š1min 1æ¬¡
 616           *
 617           *  @return   xx
 618           *
 619           *  @note      
 620           *
 621           */
 622          /*------------------------------------------------------------------------------------------------------*/
 623          void BleDrv_BleStatuChk(void)
 624          {
 625   1              uchar8  V_ucBleStatus=BLE_STAT_NORESP;
 626   1              uchar8  p_ucDataBuf[RXBUF_LEN] = ""; 
 627   1              uchar8  i = 0;
 628   1              
 629   1              V_ucBleStatus = BleDrv_GetBleStat();
 630   1              
 631   1              do{
 632   2                      /*å¦‚æœæ£€æµ‹åˆ°ç”µè¡¨ä¿®æ”¹è¡¨åœ°å€å‘½ä»¤æœªå®Œæˆï¼Œåˆ™ä¸è¿›è¡Œè¿™æ¬¡è“ç‰™å‚æ•°æ£€æŸ¥*/
 633   2                      if( (BLE_STAT_MAC_MOD == V_ucBleStatus)||(BLE_STAT_RST == V_ucBleStatus) )
 634   2                      {
 635   3                              break;
 636   3                      }
 637   2      
 638   2                      if( BLE_STAT_IDLE == V_ucBleStatus )                    /* å¤„äºç©ºé—²çŠ¶æ€*/
 639   2                      {
 640   3                              GStr_Monitor.ucBleConnectCnt = 0;                       /* éè¿æ¥çŠ¶æ€ä¸‹æ¸…é›¶ï¼Œç¡®ä¿è¿æ¥æ—¶ä»0å¼€å§‹è®¡æ—¶*/
 641   3                              BleDrv_SetBleRunPara();                                         /*è®¾ç½®è¿è¡Œå‚æ•°ï¼Œèµ·åŠ¨å¹¿æ’­*/
 642   3                      }
 643   2                      else if( BLE_STAT_ADV_ON == V_ucBleStatus )             /* å¤„äºå¹¿æ’­çŠ¶æ€*/
 644   2                      {
 645   3                              GStr_Monitor.ucBleConnectCnt = 0;                       /* éè¿æ¥çŠ¶æ€ä¸‹æ¸…é›¶ï¼Œç¡®ä¿è¿æ¥æ—¶ä»0å¼€å§‹è®¡æ—¶*/
 646   3                              /*é—´éš”ä¸‰ä¸ªå°æ—¶ï¼Œå®šæ—¶å¹¿æ’­ä¸€ä¸‹*/
 647   3                              if( GStr_Monitor.ucBleAdvCnt > 180 )
 648   3                              {
 649   4                                      GStr_Flag.ucBLESTATFlag = BLE_STAT_RST; /*è“ç‰™æ¨¡å—éœ€è¦é‡å¯ï¼Œé‡æ–°è®¾ç½®å‚æ•°*/
 650   4                              }
 651   3                      }
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 12  

 652   2                      else if( BLE_STAT_CONNECTED == V_ucBleStatus )  /* å¤„äºè¿æ¥çŠ¶æ€*/
 653   2                      {
 654   3                              if( ( (GStr_Flag.ucMeterMode & F_FACTORY_MODE) != F_FACTORY_MODE )              /* å‚å†…æ¨¡å¼çš„è¡¨ä¸ä¼šå»åˆ¤å¿
             -ƒè·³ */
 655   3                                      && ( (++GStr_Monitor.ucBleConnectCnt) > 3) )    /* è¿æ¥çŠ¶æ€ä¸‹è¿ç»­2åˆ†é’Ÿæ²¡æœ‰æ”¶åˆ°å¿ƒè·³ä¿¡å·ï¼
             -ˆæœ€å¤š3åˆ†é’Ÿï¼‰ï¼Œç›´æ¥å¤ä½*/
 656   3                              {
 657   4                                      GStr_Monitor.ucBleConnectCnt = 0;
 658   4                                      GStr_Flag.ucBLESTATFlag = BLE_STAT_RST; /*è“ç‰™æ¨¡å—éœ€è¦é‡å¯ï¼Œé‡æ–°è®¾ç½®å‚æ•°*/
 659   4                              }
 660   3                      }
 661   2      
 662   2                      /*æ²¡æœ‰åˆ°4åˆ†é’Ÿçš„æ—¶é—´é—´éš”ï¼Œç›´æ¥breaké€€å‡º*/
 663   2                      if( (GStr_Monitor.ucBleAdvCnt & B0000_0011) != B0000_0011 )
 664   2                      { 
 665   3                              break;
 666   3                      }
 667   2                      
 668   2                      /*è¿æ¥çŠ¶æ€ï¼Œæ¯éš”4åˆ†é’Ÿè¿›è¡Œæ ¡éªŒï¼Œè¯»macæŸ¥çœ‹æ˜¯å¦æœ‰é—®é¢˜*/
 669   2                      if( _SUCCESS == BleDrv_GetBlePara(COMM_BLE_MAC, p_ucDataBuf, BLE_MAC_Len) )
 670   2                      {
 671   3                              for( i=0; i<6; i++ )    /*æ£€éªŒè¯»å›æ¥çš„MACæ˜¯å¦ä¸€è‡´*/
 672   3                              {
 673   4                                      if( p_ucDataBuf[i] != GStr_BLEGroup.ucBleMAC[5-i])
 674   4                                              break;
 675   4                              }
 676   3                              if( i < 6 )
 677   3                              {
 678   4                                      BleDrv_BleReset();
 679   4                                      BleDrv_InitBleRunPara();
 680   4                                      BleDrv_SetBleStat();     
 681   4                              }
 682   3                      }
 683   2                      else    /*æ•°æ®æ²¡æœ‰è¯»æˆåŠŸï¼Œç›´æ¥åˆå§‹åŒ–*/
 684   2                      {
 685   3                              BleDrv_BleReset();
 686   3                              BleDrv_InitBleRunPara();
 687   3                              BleDrv_SetBleStat();     
 688   3                      }
 689   2              }while(0);
 690   1      }
 691          /*------------------------------------------------------------------------------------------------------*/
 692          /**
 693           *  @brief    è·å–è“ç‰™ä¸²å£çŠ¶æ€
 694           *
 695           *  @return   _IDLEï¼šç©ºé—²  _BUSYï¼šå¿™
 696           *
 697           *  @note     é™¤äº†æ¥æ”¶å’Œå‘é€çŠ¶æ€ï¼Œå…¶ä½™çŠ¶æ€éƒ½ä¸ºç©ºé—²çŠ¶æ€
 698           *
 699           */
 700          /*------------------------------------------------------------------------------------------------------*/
 701          uchar8 BleDrv_GetBleUartSta(void)
 702          {
 703   1              if( (API_COMM_STATUS_SEND == Gstr_UartComm[CH_BLE].ucCommChStatus) || 
 704   1                      (API_COMM_STATUS_RECV == Gstr_UartComm[CH_BLE].ucCommChStatus) )
 705   1              {
 706   2                      return _BUSY;
 707   2              }
 708   1              return _IDLE;
 709   1      }
 710          /*------------------------------------------------------------------------------------------------------*/
 711          /**
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 13  

 712           *  @brief    åˆå§‹åŒ–è“ç‰™è¿è¡Œå‚æ•°
 713           *
 714           *  @return   æ— 
 715           *
 716           *  @note      
 717           *
 718           */
 719          /*------------------------------------------------------------------------------------------------------*/
 720          
 721          void BleDrv_InitBleRunPara( void )
 722          {
 723   1              /*-----------------------------------------------------------*/
 724   1              // MACé»˜è®¤ä¸º6å­—èŠ‚bcdæ ¼å¼çš„é€šä¿¡åœ°å€è½¬ç»™5å­—èŠ‚hexæ ¼å¼ï¼Œé«˜ä¸¤ä½æ’å®šä¸ºC0Hï¼Œéšæœºåœ°å
             -€ä¸­çš„é™æ€åœ°å€ï¼Œmcuæ— æ³•å®ç°è½¬åŒ–ï¼Œç›´æ¥å°†åœ°å€ä¼ ç»™æ¨¡å—ï¼Œè®©æ¨¡å—è‡ªè¡Œè½¬åŒ–
 725   1              LibPub_MemCopyBytes( &GStr_MeterIFO.ucaCommAddr[0], &GStr_BLEGroup.ucBleMAC[0], 6 );    
 726   1              //GStr_BLEGroup.ucBleMAC[5] = 0xC0; 
 727   1              
 728   1              /*-----------------------------------------------------------*/
 729   1              // è®¾å¤‡åç§°é»˜è®¤ä¸ºMACåœ°å€
 730   1              LibPub_HEXtoAscii(&GStr_BLEGroup.ucBleMAC[0], &GStr_BLEGroup.ucBleName[0], 6 ); 
 731   1              
 732   1              /*-----------------------------------------------------------*/
 733   1              // é…å¯¹å¯†ç é»˜è®¤ä¸ºFFFFFF  
 734   1              GStr_BLEGroup.ucBleKey[0] = 0x00;//12;
 735   1              GStr_BLEGroup.ucBleKey[1] = 0x00;//34;
 736   1              GStr_BLEGroup.ucBleKey[2] = 0x00;//56;
 737   1              
 738   1              /*-----------------------------------------------------------*/
 739   1              // å¹¿æ’­é—´éš”é»˜è®¤100ms      
 740   1              GStr_BLEGroup.usAdvTime = 0x0100;
 741   1              
 742   1              /*-----------------------------------------------------------*/
 743   1              // è®¾ç½®è“ç‰™å‘å°„åŠŸç‡ç­‰çº§ï¼Œé»˜è®¤06çº§ 00è¡¨ç¤º0db(ä¸å¯è®¾);01è¡¨ç¤º-2db;02è¡¨ç¤º-4db;03è¡¨ç¤º
             --10db;04è¡¨ç¤º-20db;05è¡¨ç¤º2db;06è¡¨ç¤º3db(é»˜è®¤)
 744   1              //GStr_BLEGroup.ucBleTPL = 0x06;
 745   1              
 746   1              // è®¾ç½®è“ç‰™smpç­‰çº§        é»˜è®¤éœ€è¦é…å¯¹
 747   1              //GStr_BLEGroup.ucSMPLevel = '0';
 748   1      
 749   1              /*-----------------------------------------------------------*/
 750   1              // è®¾ç½®è¿è¡Œå‚æ•°   
 751   1              BleDrv_SetBleRunPara();
 752   1              
 753   1              LibPub_WriteDataToE2prom( LIB_E2P_BLE_PARA, 0, (uchar8*)&GStr_BLEGroup.ucBleMAC[0] );
 754   1      }
 755          /*------------------------------------------------------------------------------------------------------*/
 756          /**
 757           *  @brief    è®¾ç½®è“ç‰™è¿è¡Œå‚æ•°
 758           *
 759           *  @return   æ— 
 760           *
 761           *  @note      
 762           *
 763           */
 764          /*------------------------------------------------------------------------------------------------------*/
 765          
 766          void BleDrv_SetBleRunPara( void )
 767          {
 768   1              uchar8 V_ucTempBufA[25]="";
 769   1      //      uchar8 V_ucTempBufB[20]="";
 770   1      //      uchar8 V_ucCnti,V_ucCntj;
 771   1              
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 14  

 772   1              /*----------------------------------------------------------*/
 773   1              // è®¾ç½®Mac
 774   1              LibPub_MemExchangeBytes( &GStr_BLEGroup.ucBleMAC[0], V_ucTempBufA, 6);          /* MACï¼Œå€’åºä¼ è¾“ */ 
 775   1              LibPub_MemCopyBytes( &GStr_BLEGroup.ucBleName[0], V_ucTempBufA+6, 12);  /* åç§° */ 
 776   1              LibPub_MemCopyBytes( &GStr_BLEGroup.ucBleKey[0], V_ucTempBufA+18, 3);   /* é…å¯¹ç  */ 
 777   1              BleDrv_SetBleMac( V_ucTempBufA );
 778   1      
 779   1              V_ucTempBufA[0] = GStr_BLEGroup.ucBleTPL;
 780   1      
 781   1              //è®¾ç½®å‘å°„åŠŸç‡ 
 782   1              BleDrv_SetBleTPL( &V_ucTempBufA[0] );
 783   1              
 784   1              //å¯åŠ¨å¹¿æ’­
 785   1              BleDrv_SetBleStat();
 786   1              // LibPub_MemCopyBytes(&GStr_BLEGroup.ucBleMAC[0], &p_ucDataBuff[0], 6);
 787   1              // LibPub_MemCopyBytes(&GStr_BLEGroup.ucBleKey[0], &p_ucDataBuff[10], 3);
 788   1                      
 789   1              /*----------------------------------------------------------*/
 790   1              // è®¾ç½®é…å¯¹ç 
 791   1              /*
 792   1              LibPub_MemSetBytes( &V_ucTempBufA, 0x00, 20 );
 793   1              LibPub_HEXtoAscii( &GStr_BLEGroup.ucBleKey[0], V_ucTempBufA, 3);
 794   1              BleDrv_SetBleKey( V_ucTempBufA );
 795   1              */
 796   1              
 797   1      //      /*----------------------------------------------------------*/
 798   1      //      // è®¾ç½®æ¨¡å—åç§°
 799   1      //      BleDrv_SetBleName( &GStr_BLEGroup.ucBleName[0] );
 800   1              
 801   1              /*----------------------------------------------------------*/
 802   1              // è®¾ç½®å¹¿æ’­å‘¨æœŸ
 803   1              /*
 804   1              LibPub_MemSetBytes( &V_ucTempBufA, 0x00, 20 );
 805   1              LibPub_MemSetBytes( &V_ucTempBufB, 0x00, 20 );
 806   1              V_ucTempBufA[0] = (uchar8) ( (GStr_BLEGroup.usAdvTime>>8) & 0x00ff );
 807   1              V_ucTempBufA[1] = (uchar8) ( (GStr_BLEGroup.usAdvTime   ) & 0x00ff );
 808   1      //      LibPub_HEXtoAscii( (uchar8 *) &(GStr_BLEGroup.usAdvTime), V_ucTempBufA, 2);     
 809   1              LibPub_HEXtoAscii(  &V_ucTempBufA[0], &V_ucTempBufA[10], 2 );   
 810   1              for(V_ucCnti=0;V_ucCnti<4;V_ucCnti++)
 811   1              {
 812   1                      if(V_ucTempBufA[10+V_ucCnti] != '0' )
 813   1                      {
 814   1                              for(V_ucCntj=0; V_ucCntj<4; V_ucCntj++)
 815   1                              {
 816   1                                      V_ucTempBufB[V_ucCntj] = V_ucTempBufA[10+V_ucCnti+V_ucCntj];
 817   1                              }
 818   1                              break;
 819   1                      }
 820   1              }
 821   1              BleDrv_SetBleADVP( V_ucTempBufB );
 822   1              */
 823   1              
 824   1              /*----------------------------------------------------------*/
 825   1              // è®¾ç½®é…å¯¹ç­‰çº§
 826   1              /*
 827   1              BleDrv_SetBleSMPLv( &GStr_BLEGroup.ucSMPLevel );
 828   1              */
 829   1              
 830   1      }
 831          
 832          /*------------------------------------------------------------------------------------------------------*/
 833          /**
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 15  

 834           *  @brief    è®¾ç½®æˆ–æŸ¥è¯¢æ¨¡å—ä¿¡æ¯
 835           *
 836           *  @param    v_ucOptIndex : åŠŸèƒ½å­—ç´¢å¼•
 837           *  @param    C_cBleCmd : æ§åˆ¶ç 
 838           *  @param    p_ucDataBuff : è¦è®¾ç½®æˆ–è€…æ•°æ®è¿”å›çš„æŒ‡é’ˆ
 839           *
 840           *  @return   xx
 841           *
 842           *  @note     xx
 843           *
 844           */
 845          /*------------------------------------------------------------------------------------------------------*/
 846          uchar8 BleDrv_BleComm(uchar8 v_ucOptIndex, uchar8 C_cBleCmd, uchar8 *p_ucDataBuff)
 847          {
 848   1              uchar8  V_ucResult = _FAILED,V_ucRxFlg=_FALSE;
 849   1              uchar8  V_ucCnti=0,V_ucCntk=0,V_ucLen=0,v_ucLen=0;
 850   1              uchar8  V_ucTempDataBuf[RXBUF_LEN]=""; 
 851   1              uchar8  *P_ucTempDataBuf = V_ucTempDataBuf;
 852   1              uchar8  V_ucIndex;
 853   1              ushort16        V_usCntj;
 854   1              ulong32 V_ucDataId;      
 855   1      
 856   1              /*æ‰ç”µå°±é€€å‡º*/
 857   1              if ( GStr_Flag.ucSystem & F_PWOFF_NOW )
 858   1              {
 859   2                      return V_ucResult;
 860   2              }
 861   1              /*åˆ¤æ–­ä¸²å£æ˜¯å¦æ˜¯ç©ºé—²çŠ¶æ€*/
 862   1              if( _BUSY == BleDrv_GetBleUartSta() )
 863   1              {
 864   2                      return BLE_STAT_BUSY;
 865   2              }
 866   1              
 867   1              do{     
 868   2                      /*åˆ¤æ–­ç´¢å¼•æ˜¯å¦åœ¨èŒƒå›´å†…*/
 869   2                      for( V_ucIndex=0; V_ucIndex< MAX_C_StrBle_MAP_TAB; V_ucIndex++ )        
 870   2                      {
 871   3                              if( C_StrBle_MAP_TAB[V_ucIndex].ucIndex == v_ucOptIndex )
 872   3                              {
 873   4                                      V_ucDataId = C_StrBle_MAP_TAB[V_ucIndex].ucaDataId;
 874   4                                      v_ucLen = C_StrBle_MAP_TAB[V_ucIndex].ucaDataLen;
 875   4                                      break;  /*æ‰¾åˆ°äº†è·³å‡ºforå¾ªç¯*/
 876   4                              }
 877   3                      }
 878   2                      if( V_ucIndex >= MAX_C_StrBle_MAP_TAB )
 879   2                      {
 880   3                              break;  /*æ‰¾ä¸åˆ°å°±ç›´æ¥é€€å‡ºè·³å‡ºdo-whileå¾ªç¯*/
 881   3                      }
 882   2      
 883   2                      /*æ‰¾åˆ°å¯¹åº”çš„ç´¢å¼•å·äº†ï¼Œå‡†å¤‡æ•°æ®*/  
 884   2                      for( V_ucCntk=0; V_ucCntk< 3; V_ucCntk++ )      /*é”™äº†é‡è¯•ï¼Œæ€»å…±3æ¬¡*/
 885   2                      {
 886   3                              /*æ‰ç”µå°±é€€å‡º*/
 887   3                              if ( GStr_Flag.ucSystem & F_PWOFF_NOW )
 888   3                              { 
 889   4                                      break;
 890   4                              }
 891   3                              
 892   3                              v_ucLen = v_ucLen +4;   /*æ•°æ®é•¿åº¦éœ€è¦åŠ ä¸Š4ä¸ªå­—èŠ‚çš„æ•°æ®æ ‡è¯†é•¿åº¦*/
 893   3                              if( C_cBleCmd == BLE_RW_READ )  /*è¯»æ•°æ®ï¼Œæ•°æ®é•¿åº¦æ°¸è¿œä¸º4ï¼Œæ•°æ®æ ‡è¯†*/
 894   3                              {
 895   4                                      v_ucLen = 4;
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 16  

 896   4                              }
 897   3      
 898   3                              LibPub_MemSetBytes( &V_ucTempDataBuf[0], 0xFE, 4 );     /*ç»„ç»‡4ä¸ªFE*/
 899   3                              V_ucTempDataBuf[4] = 0x68;      /*å¸§èµ·å§‹ç¬¦*/
 900   3                              V_ucTempDataBuf[5] = (uchar8)(v_ucLen&0xFF);    /*é•¿åº¦ä½8ä½*/
 901   3                              V_ucTempDataBuf[6] = (uchar8)(0xFF00&v_ucLen>>8);       /*é•¿åº¦é«˜8ä½*/
 902   3                              LibPub_MemSetBytes( &V_ucTempDataBuf[7], 0xFF, 6 );     /*ç›®æ ‡è®¾å¤‡åœ°å€,è®¾ç½®å‘½ä»¤ä¸ºå…¨F*/
 903   3                              V_ucTempDataBuf[13] = 0x00;             /*é“¾è·¯çŠ¶æ€ä¸º00ï¼Œéé€ä¼ */
 904   3                              V_ucTempDataBuf[14] = 0x00;             /*é¢„ç•™æ‰©å±•å­—èŠ‚ï¼Œé»˜è®¤00*/
 905   3                              V_ucTempDataBuf[15] = 0x68;             /*å¸§èµ·å§‹ç¬¦*/
 906   3                              V_ucTempDataBuf[16] = C_cBleCmd;                /*æ§åˆ¶ç */
 907   3                              V_ucTempDataBuf[17] = (uchar8)(V_ucDataId>>24);
 908   3                              V_ucTempDataBuf[18] = (uchar8)(V_ucDataId>>16);
 909   3                              V_ucTempDataBuf[19] = (uchar8)(V_ucDataId>>8);
 910   3                              V_ucTempDataBuf[20] = (uchar8)(V_ucDataId);
 911   3                              LibPub_MemCopyBytes( p_ucDataBuff, &V_ucTempDataBuf[21], v_ucLen-4 );           /*æ•°æ®åŸŸ*/
 912   3                              V_ucTempDataBuf[17+v_ucLen] = LibPub_CalSum( &V_ucTempDataBuf[4], v_ucLen + 13) ;
 913   3                              V_ucTempDataBuf[v_ucLen + 18] = 0x16;           /*å¸§å°¾*/
 914   3      
 915   3                              V_ucLen = v_ucLen + 19;         /*å‘é€æ•°æ®æ€»é•¿åº¦*/
 916   3      
 917   3                              /*å¼€å§‹å‘é€æ•°æ®*/
 918   3                              ApiPwOn_UART_SendEn(CH_UART_UART1);
 919   3                              IEN1  &= ~IEN1_ES1;             /*ä¸éœ€è¦ä¸­æ–­*/
 920   3                              //BleDrv_WakeUpBle(BLE_TRMODE_AT);      //ä¸é‡‡ç”¨ATåè®®ï¼Œå–æ¶ˆå”¤é†’å£çº¿
 921   3      
 922   3                              for( V_ucCnti=0; V_ucCnti< V_ucLen; V_ucCnti++ )
 923   3                              {
 924   4                                      ACC = V_ucTempDataBuf[V_ucCnti];
 925   4                                      if( P )
 926   4                                      {
 927   5                                              TB81 = 1;
 928   5                                      }
 929   4                                      else
 930   4                                      {
 931   5                                              TB81 = 0;
 932   5                                      }
 933   4                                      SBUF1 = V_ucTempDataBuf[V_ucCnti];
 934   4                                      for( V_usCntj=0; V_usCntj< 2000; V_usCntj++ ) 
 935   4                                      {
 936   5                                              if( TI1 )
 937   5                                              {
 938   6                                                      TI1 = 0;
 939   6                                                      break;
 940   6                                              }
 941   5                                              LibPub_Delay2us();
 942   5                                      }
 943   4                                      if( V_usCntj>=2000 )
 944   4                                      {
 945   5                                              break;          /*è¶…æ—¶ä¸€æ¬¡å°±é€€å‡º*/
 946   5                                      }
 947   4                              }
 948   3                              
 949   3                              /*é…ç½®ä¸²å£*/
 950   3                              SCON1 |=  SCON1_REN1;
 951   3                              IEN1  &= ~IEN1_ES1;             /*ä¸éœ€è¦ä¸­æ–­*/
 952   3      
 953   3                              V_ucLen = RXBUF_LEN;
 954   3                              
 955   3                              /*å¼€å§‹æ¥æ”¶æ•°æ®*/
 956   3                              for( V_ucCnti=0; V_ucCnti< V_ucLen; V_ucCnti++ )
 957   3                              { 
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 17  

 958   4                                      for( V_usCntj=0; V_usCntj< 8000; V_usCntj++ ) 
 959   4                                      {
 960   5                                              if( RI1 )
 961   5                                              {
 962   6                                                      RI1 = 0;
 963   6                                                      V_ucTempDataBuf[V_ucCnti] = SBUF1;  
 964   6      
 965   6                                                      V_ucRxFlg = _TRUE;              /*åªè¦æœ‰æ•°æ®å›ï¼Œåˆ™è®¤ä¸ºå°±æ˜¯æœ‰å“åº”ï¼Œè®¤ä¸ºé€šä¿¡æˆåŠŸ*/
 966   6                                                      break;
 967   6                                              }
 968   5                                      }
 969   4                                      if( V_usCntj>=8000 )
 970   4                                      {
 971   5                                              break;          /*è¶…æ—¶ä¸€æ¬¡å°±é€€å‡º*/
 972   5                                      }
 973   4                              }
 974   3                              if( V_ucRxFlg == _TRUE )                /*æœ‰æ•°æ®è¿”å›ï¼Œå°±è®¤ä¸ºæœ¬æ¬¡å‘é€å·²ç»å‘ç»™è“ç‰™æ¨¡å—ï¼Œè¡¨ç¤ºæˆ
             -åŠŸ*/
 975   3                              {
 976   4                                      V_ucResult = _SUCCESS;
 977   4                                      V_ucCntk = 3;
 978   4                              }
 979   3                              
 980   3                              if( V_ucResult == _SUCCESS )            /*æœ‰æ•°æ®è¿”å›ï¼Œåˆ™æŠŠæ•°æ®å¸¦å›å³å¯*/
 981   3                              {
 982   4                                      LibPub_MemCopyBytes( &V_ucTempDataBuf[21], &p_ucDataBuff[0], C_StrBle_MAP_TAB[V_ucIndex].ucaDataLen);   
             -/*ç¬¬18ä¸ªå¼€å§‹ä¸ºæ•°æ®*/
 983   4                              }
 984   3                              
 985   3                              /*è“ç‰™å¯ä»¥è¿›å…¥ä¼‘çœ */
 986   3                              //BleDrv_WakeUpBle(BLE_TRMODE_DIS);     //ä¸é‡‡ç”¨ATåè®®ï¼Œå–æ¶ˆå”¤é†’å£çº¿                        
 987   3                      }
 988   2              }while(0);
 989   1      
 990   1              /*ç»“æŸé€€å‡º*/        
 991   1              return(V_ucResult);
 992   1      }
 993          /*------------------------------------------------------------------------------------------------------*/
 994          /**
 995           *  @brief    é€šè¿‡è“ç‰™ATå‘½ä»¤æ“ä½œè“ç‰™æ¨¡å—ï¼Œè®¾ç½®æˆ–æŸ¥è¯¢æ¨¡å—ä¿¡æ¯
 996           *
 997           *  @param    v_ucTRMode : å”¤é†’æ¨¡å¼   å”¤é†’ä¸²å£ï¼Œå”¤é†’åæŒç»­ï¼Œä¼ è¾“ATå‘½ä»¤
 998           *
 999           *  @return   xx
1000           *
1001           *  @note     xx
1002           *
1003           */
1004          /*------------------------------------------------------------------------------------------------------*/
1005          //void BleDrv_WakeUpBle( uchar8 v_ucTRMode )
1006          //{
1007          //      
1008          //      // å…ˆæ¿€æ´»è“ç‰™æ¨¡å—ä¸²å£ï¼Œæ‹‰ä½2msåœ¨æ‹‰é«˜ï¼Œè¡¨ç¤ºå”¤é†’ï¼Œå¦‚æœæŒç»­æ‹‰ä½åˆ™è¡¨ç¤ºéœ€è¦å
             -‘é€çš„æ•°æ®æ˜¯ATå‘½ä»¤
1009          //      if(  BLE_TRMODE_DIS & v_ucTRMode )
1010          //      {
1011          //              BLE_WAKEUP_IO_H();      // æ‹‰é«˜ï¼Œä¼šè¿›å…¥ç¡çœ æ¨¡å¼
1012          //      }
1013          //      else
1014          //      {
1015          //              BLE_WAKEUP_IO_L();      // æ‹‰ä½å”¤é†’ 
1016          //              
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 18  

1017          //              LibPub_DelayNms(3);                     // å»¶è¿Ÿ 3ms
1018          //              
1019          //              if( BLE_TRMODE_UART & v_ucTRMode )      // å¦‚æœæ˜¯ä¸²å£ä¼ è¾“æ¨¡å¼ï¼Œåˆ™å°†ATå£æ‹‰é«˜ï¼Œå¦åˆ™æŒç»­æ‹
             -‰ä½å³å¯
1020          //              {
1021          //                      BLE_WAKEUP_IO_H();;
1022          //              }
1023          //      }   
1024          //} 
1025          /*------------------------------------------------------------------------------------------------------*/
1026          /**
1027           *  @brief    é€šä¿¡ä¸æ­£å¸¸æ—¶ï¼Œå¤ä½è“ç‰™æ¨¡ç»„
1028           *
1029           *  @return   xx
1030           *
1031           *  @note     xx
1032           *
1033           */
1034          /*------------------------------------------------------------------------------------------------------*/
1035          void BleDrv_BleReset(void)
1036          {
1037   1              BLE_POWER_OFF();
1038   1              LibPub_DelayNms(150);
1039   1              BLE_POWER_ON();
1040   1              LibPub_DelayNms(500);
1041   1              Gstr_UartComm[CH_BLE].ucCommChStatus = API_COMM_STATUS_IDLE;    /*ä¸²å£å¤„äºç©ºé—²çŠ¶æ€*/
1042   1      }
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 19  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


uint16_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
IB_CON2. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F3H  1
COMM_BLE_STAT. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
API_COMM_STATUS_OVERTIME . . . . . . .  E_CONST  -----  U_CHAR   -----  1
TB81 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00DBH  1
P0 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0080H  1
IB_CON3. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F4H  1
FP64 . . . . . . . . . . . . . . . . .  TYPEDEF  -----  FLOAT    -----  4
TKCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A4H  1
P1 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0090H  1
IB_CON4. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F5H  1
PASLO. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E7H  1
GStr_ENERGYDEC_Type. . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  26
  ucaFw_EnergyDec. . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  13
  ucaBk_EnergyDec. . . . . . . . . . .  MEMBER   -----  ARRAY    000DH  13
P2 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A0H  1
OSCLO. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00FEH  1
IB_CON5. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F6H  1
GStr_EventRecordNum_Type . . . . . . .  TYPEDEF  -----  STRUCT   -----  26
  ucEventTimes . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  24
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0018H  2
GStr_FLAG_Type . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  16
  ucSystem . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  ucMeterMode. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  ucPwOnState. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  ucRunState . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
  ucRunState2. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
  ucRunState1. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0007H  1
  ucRunState3. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0008H  1
  ucDisp . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0009H  1
  ucFactoryKey . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000AH  1
  ucDispKey. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000BH  1
  ucMoney. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000CH  1
  ucPowerOnFlag. . . . . . . . . . . .  MEMBER   -----  U_CHAR   000DH  1
  ucWrE2promSafeByte . . . . . . . . .  MEMBER   -----  U_CHAR   000EH  1
  ucBLESTATFlag. . . . . . . . . . . .  MEMBER   -----  U_CHAR   000FH  1
BOOLEAN. . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
SM1_RXOV . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      009EH  1
P3 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B0H  1
AC . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D6H  1
P4 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C0H  1
BleDrv_SetBleStat. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  V_ucTempBuff . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0000H  40
  V_ucResult . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0028H  1
SPCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A1H  1
SBRTH. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   009CH  1
P5 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E9H  1
TRIPEMU_CALPARA_Type . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  114
  ulaCalPara . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  112
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0070H  2
LIB_E2P_Price_BAK. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
EA . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00AFH  1
P6 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00EAH  1
LIB_E2P_Display_Table. . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_DISPLAY_PARA_Type . . . . . . . .  TYPEDEF  -----  STRUCT   -----  129
  ucFullDisp_Time. . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 20  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  ucDispDurTime. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  ucAutoDispNum. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  ucKeyDispNum . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  usDisp_ParaCRC16 . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
  ucAutoDisptable. . . . . . . . . . .  MEMBER   -----  ARRAY    0006H  30
  ucKeyDisptable . . . . . . . . . . .  MEMBER   -----  ARRAY    0024H  30
  usDisp_tableCRC16. . . . . . . . . .  MEMBER   -----  U_INT    0042H  2
  ucBackLightTime. . . . . . . . . . .  MEMBER   -----  U_CHAR   0044H  1
  ucRelayLEDTime . . . . . . . . . . .  MEMBER   -----  U_CHAR   0045H  1
  ulDispUpdataTime . . . . . . . . . .  MEMBER   -----  U_LONG   0046H  4
  usDispCnt. . . . . . . . . . . . . .  MEMBER   -----  U_INT    004AH  2
  ulDisptimer. . . . . . . . . . . . .  MEMBER   -----  U_LONG   004CH  4
  ucKeydelaytimer. . . . . . . . . . .  MEMBER   -----  U_CHAR   0050H  1
  ucFirstKeyDisp . . . . . . . . . . .  MEMBER   -----  U_CHAR   0051H  1
  ucDisp_0_flag. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0052H  1
  ucDisp_tongxin_Flag. . . . . . . . .  MEMBER   -----  U_CHAR   0053H  1
  ucDisp_tongxin_Time. . . . . . . . .  MEMBER   -----  U_LONG   0054H  4
  ucDispNum. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0058H  1
  ucLCDDrvDispBuf. . . . . . . . . . .  MEMBER   -----  ARRAY    0059H  40
int32_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
P7 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00EBH  1
IB_DATA. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00EFH  1
P8 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00ECH  1
int16_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
SBRTL. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   009DH  1
P9 . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00EDH  1
PBANKLO. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B7H  1
GStr_COUNTER_Type. . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  10
  ucFactoryMode_Cnt. . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  ucKeyRelayOn_Cnt . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  ucRelayDelay_Cnt . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
  ucHoldMoney_Cnt. . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  ucPasswordErr_Cnt. . . . . . . . . .  MEMBER   -----  ARRAY    0006H  3
  ucRelayon_Cnt. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0009H  1
BleDrv_InitBleRunPara. . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
SPSTA. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A2H  1
IEN0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A8H  1
PWRCON1. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B3H  1
ulong32. . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
EMUSR. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0095H  1
IEN1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A9H  1
PWRCON2. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B4H  1
DPH1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0085H  1
P0_0 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0080H  1
ushort16 . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
P1_0 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0090H  1
P0_1 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0081H  1
ADCH . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C3H  1
BLE_DRV_OPERATION_INDEX. . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
LIB_E2P_SOFTI_J. . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
P2_0 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A0H  1
P1_1 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0091H  1
P0_2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0082H  1
IPH0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00BAH  1
DPL1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0084H  1
size_t . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
LIB_E2P_FUN_CONFIG_BAK . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 21  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


GStr_MONITOR_Tpye. . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  63
  ulTimer_ms . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0000H  4
  ulTimer_ms_old . . . . . . . . . . .  MEMBER   -----  U_LONG   0004H  4
  ulTimerClrWDT. . . . . . . . . . . .  MEMBER   -----  U_LONG   0008H  4
  ulTimerMin . . . . . . . . . . . . .  MEMBER   -----  U_LONG   000CH  4
  ulTimer5ms . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0010H  4
  ucPowerOnTimer . . . . . . . . . . .  MEMBER   -----  U_CHAR   0014H  1
  ulTimers . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0015H  4
  ulUpDateUIPTime. . . . . . . . . . .  MEMBER   -----  U_LONG   0019H  4
  ulSoftI_JTime. . . . . . . . . . . .  MEMBER   -----  U_LONG   001DH  4
  usSoftI_JTimeCRC16 . . . . . . . . .  MEMBER   -----  U_INT    0021H  2
  usPasswordErrTime. . . . . . . . . .  MEMBER   -----  ARRAY    0023H  8
  ucCommSymbolTime . . . . . . . . . .  MEMBER   -----  U_CHAR   002BH  1
  ucPowerLimitNum. . . . . . . . . . .  MEMBER   -----  U_CHAR   002CH  1
  ulOverDemandCloseTime. . . . . . . .  MEMBER   -----  U_LONG   002DH  4
  ulProgEventDelayTime . . . . . . . .  MEMBER   -----  U_LONG   0031H  4
  ulReadRandom2DelayTime . . . . . . .  MEMBER   -----  U_LONG   0035H  4
  ucBleAdvCnt. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0039H  1
  ucBleConnectCnt. . . . . . . . . . .  MEMBER   -----  U_CHAR   003AH  1
  ulPulsewidth . . . . . . . . . . . .  MEMBER   -----  U_LONG   003BH  4
P3_0 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B0H  1
P2_1 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A1H  1
P1_2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0092H  1
P0_3 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0083H  1
IPH1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00BBH  1
COMM_BLE_MAC . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
P4_0 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C0H  1
P3_1 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B1H  1
P2_2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A2H  1
P1_3 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0093H  1
P0_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0084H  1
EXF0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E8H  1
P4_1 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C1H  1
P3_2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B2H  1
P2_3 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A3H  1
P1_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0094H  1
P0_5 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0085H  1
P4_2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C2H  1
P3_3 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B3H  1
P2_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A4H  1
P1_5 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0095H  1
P0_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0086H  1
EXF2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00CEH  1
TKF0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A6H  1
IPL0 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B8H  1
LIB_E2P_ENRGY_BAK. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
P4_3 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C3H  1
P3_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B4H  1
P2_5 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A5H  1
P1_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0096H  1
P0_7 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0087H  1
REN1 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00DCH  1
IPL1 . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B9H  1
LIB_E2P_EventNum . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
long32 . . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
P4_4 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C4H  1
P3_5 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B5H  1
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 22  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


P2_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A6H  1
P1_7 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0097H  1
TK0H . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E2H  1
SUSLO. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   008EH  1
P4_5 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C5H  1
P3_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B6H  1
P2_7 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A7H  1
P3CR . . . . . . . . . . . . . . . . .  EXTERN   XDATA  U_CHAR   -----  1
TK1H . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E4H  1
P4_6 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C6H  1
P3_7 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B7H  1
TK2H . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E6H  1
LIB_E2P_Money_BAK. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
short16. . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
P4_7 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C7H  1
RI . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0098H  1
E7816. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00AAH  1
CY . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D7H  1
TK0L . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E1H  1
API_COMM_STATUS_ERROR. . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_LibPub_CrcCheck . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
TI . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      0099H  1
EADR . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0091H  1
TK1L . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E3H  1
TK2L . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E5H  1
SADEN1 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00DBH  1
SM10_FE1 . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00DFH  1
SADEN2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00FBH  1
LIB_E2P_EMU_CALPARA. . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_ENERGY_PULSE_Type . . . . . . . .  TYPEDEF  -----  STRUCT   -----  8
  ucPulseAdd . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  ucPulseAddBusy . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  ucPulseStatu . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  ucPulseDecimal . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  ucPulseDecSavePtr. . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
  ucPulseDecSaveNoFF . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  ucaPulseRemain . . . . . . . . . . .  MEMBER   -----  ARRAY    0006H  2
PS0L . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00BCH  1
PT0L . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B9H  1
SADDR1 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00DAH  1
LIB_E2P_INDEX_MAX. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LIB_E2P_Display_Para . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
SM12_TXCOL1. . . . . . . . . . . . . .  ABSBIT   -----  BIT      00DDH  1
PT1L . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00BBH  1
SADDR2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00FAH  1
RCAP2H . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00CBH  1
BleDrv_GetBleUartSta . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
COMM_BLE_MOD . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
PT2L . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00BDH  1
SP . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0081H  1
BleDrv_SetBleRunPara . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  V_ucTempBufA . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0000H  25
INT32S . . . . . . . . . . . . . . . .  TYPEDEF  -----  LONG     -----  4
OV . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D2H  1
EMU_COMM_TRIPCAL_TAB_Type. . . . . . .  TYPEDEF  -----  STRUCT   -----  4
  ucCommDI1. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  ucEmuAddr. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  3
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 23  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


LIB_E2P_EventNumPiont. . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_METER_IFO_Type. . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  27
  ucaCommAddr. . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  6
  ucaMeterID . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0006H  6
  ucaUserID. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    000CH  6
  ucVoltageTrans . . . . . . . . . . .  MEMBER   -----  ARRAY    0012H  3
  ucCurrentTrans . . . . . . . . . . .  MEMBER   -----  ARRAY    0015H  3
  ucBpsVal . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0018H  1
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0019H  2
RCAP2L . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00CAH  1
INT32U . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
INT16S . . . . . . . . . . . . . . . .  TYPEDEF  -----  INT      -----  2
INT16U . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_INT    -----  2
PX4L . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00B8H  1
C_T2 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C9H  1
SFINE2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00DEH  1
TRIPEMU_UIPKms_Type. . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  6
  ulaKmsuip. . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0000H  4
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0004H  2
_LibPub_WriteDataToE2prom. . . . . . .  EXTERN   CODE   PROC     -----  -----
GStr_BLE_GROUP_Type. . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  26
  ucBleMAC . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  6
  ucBleName. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0006H  12
  ucBleKey . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0012H  3
  usAdvTime. . . . . . . . . . . . . .  MEMBER   -----  U_INT    0015H  2
  ucBleTPL . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0017H  1
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0018H  2
COMM_BLE_MFV . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_EventNumPiont_Type. . . . . . . .  TYPEDEF  -----  STRUCT   -----  8
  uc_Num . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  6
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0006H  2
IRCON1 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00ADH  1
IRCON2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00AFH  1
GStr_Comm_MAP. . . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  14
  ucaDataId. . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0000H  4
  ucaRamAdd. . . . . . . . . . . . . .  MEMBER   -----  PTR      0004H  3
  IsWrite. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0007H  1
  ucaE2pIndex. . . . . . . . . . . . .  MEMBER   -----  U_INT    0008H  2
  ucaE2offset. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000AH  1
  ucaDataLen . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000BH  1
  IsBCD. . . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000CH  1
  EEIsHEX. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   000DH  1
API_COMM_STATUS_IDLE . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LibPub_Delay2us. . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
Gstr_UartComm. . . . . . . . . . . . .  EXTERN   XDATA  ARRAY    -----  -----
EXCON1 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00ABH  1
SBUF . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0099H  1
EXCON2 . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00ACH  1
PCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0087H  1
B32_B08. . . . . . . . . . . . . . . .  * TAG *  -----  UNION    -----  4
  B08. . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  B16. . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  B32. . . . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0000H  4
AUXC . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F1H  1
COMM_BLE_TPL . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_UART_COMM_Type. . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  423
  ucCommChStatus . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 24  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  ucCommRevStep. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  ucCommRevLen . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  ucCommSndLen . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0003H  1
  ucCommSndCnt . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
  ucCommAddrType . . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  ucCommError. . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
  ulCommTimeInit . . . . . . . . . . .  MEMBER   -----  U_LONG   0007H  4
  ulCommRcvByteOverTime. . . . . . . .  MEMBER   -----  U_LONG   000BH  4
  ulCommSndByteOverTime. . . . . . . .  MEMBER   -----  U_LONG   000FH  4
  ulCommRspOverTime. . . . . . . . . .  MEMBER   -----  U_LONG   0013H  4
  ucaCommRXBuff. . . . . . . . . . . .  MEMBER   -----  ARRAY    0017H  200
  ucaCommTXBuff. . . . . . . . . . . .  MEMBER   -----  ARRAY    00DFH  200
GStr_ENERGY_Type . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  10
  ucaFw_Energy . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  ucaBk_Energy . . . . . . . . . . . .  MEMBER   -----  ARRAY    0004H  4
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0008H  2
GU_B32_B08_Type. . . . . . . . . . . .  TYPEDEF  -----  UNION    -----  4
  B08. . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  B16. . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  B32. . . . . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0000H  4
SCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0098H  1
TK0BASEH . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D4H  1
TMOD . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0089H  1
TCON . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0088H  1
IENX . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00AAH  1
IB_OFFSET. . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00EEH  1
TK1BASEH . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D6H  1
SBRT1H . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00DCH  1
TK2BASEH . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00DFH  1
SBRT2H . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00FCH  1
RSTSTAT. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B1H  1
LIB_E2P_Password . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
TK0BASEL . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D3H  1
LIB_E2P_BLE_PARA . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LIB_E2P_RUN_STATE. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
TK1BASEL . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D5H  1
SBRT1L . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00DDH  1
COMM_BLE_TTP . . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
TK2BASEL . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D7H  1
SBRT2L . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00FDH  1
API_COMM_STATUS_SEND . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
SM0_FE . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      009FH  1
CLKCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B2H  1
API_COMM_STATUS_RECV_OK. . . . . . . .  E_CONST  -----  U_CHAR   -----  1
BleDrv_BleReset. . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
C_cBlePayload_Head . . . . . . . . . .  PUBLIC   CODE   ARRAY    0000H  19
SM2_TXCOL. . . . . . . . . . . . . . .  ABSBIT   -----  BIT      009DH  1
LDOCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B5H  1
B. . . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F0H  1
API_COMM_STATUS_RECV . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_MeterIFO. . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  27
_?ix1000 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    0044H  100
_?ix1001 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    00A8H  100
_LibPub_DelayNms . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
CP_RL2 . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00C8H  1
_?ix1002 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    010CH  40
LIB_E2P_EMU_UIPKms . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 25  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


_?ix1003 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    0134H  25
_BleDrv_BleComm. . . . . . . . . . . .  STATIC   CODE   PROC     0000H  -----
  v_ucOptIndex . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  C_cBleCmd. . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
  p_ucDataBuff . . . . . . . . . . . .  AUTO     XDATA  PTR      0002H  3
  V_ucResult . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0005H  1
  V_ucRxFlg. . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0006H  1
  V_ucCnti . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0007H  1
  V_ucCntk . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0008H  1
  V_ucLen. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0009H  1
  v_ucLen. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   000AH  1
  V_ucTempDataBuf. . . . . . . . . . .  AUTO     XDATA  ARRAY    000BH  100
  P_ucTempDataBuf. . . . . . . . . . .  AUTO     XDATA  PTR      006FH  3
  V_ucIndex. . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0072H  1
  V_usCntj . . . . . . . . . . . . . .  AUTO     XDATA  U_INT    0073H  2
  V_ucDataId . . . . . . . . . . . . .  AUTO     XDATA  U_LONG   0075H  4
GStr_UIP_GROUP_Type. . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  68
  ulVoltage. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  16
  ulCurrent. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0010H  16
  ulPower. . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0020H  16
  ulFactory. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0030H  16
  ulFrequency. . . . . . . . . . . . .  MEMBER   -----  U_LONG   0040H  4
_?ix1004 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    014DH  5
ENUM_API_COMM_STATUS . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
GStr_BLEGroup. . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  26
ACC. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00E0H  1
_?ix1005 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    0152H  35
ES0. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00ACH  1
_?ix1006 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    0175H  100
ET0. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A9H  1
_?ix1007 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    01D9H  25
ET1. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00ABH  1
TF0. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      008DH  1
_?ix1008 . . . . . . . . . . . . . . .  STATIC   CODE   ARRAY    01F2H  100
_BleDrv_GetBleTPL. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  p_ucDataBuf. . . . . . . . . . . . .  * REG *  DATA   PTR      0001H  3
ET2. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00ADH  1
TF1. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      008FH  1
RI1. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D8H  1
RB8. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      009AH  1
TF2. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00CFH  1
TH0. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   008CH  1
INSCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0086H  1
TH1. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   008DH  1
uchar8 . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
TI1. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D9H  1
TB8. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      009BH  1
TH2. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00CDH  1
LIB_E2P_EMU_CALPARA_BAK. . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_Monitor . . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  63
uint8_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
P. . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D0H  1
GStr_UIP_DISPLAY_Type. . . . . . . . .  TYPEDEF  -----  STRUCT   -----  135
  ucVoltage. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  ucVoltageA . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0004H  4
  ucVoltageB . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0008H  4
  ucVoltageC . . . . . . . . . . . . .  MEMBER   -----  ARRAY    000CH  4
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 26  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


  ucCOMMVoltage. . . . . . . . . . . .  MEMBER   -----  ARRAY    0010H  4
  ucCOMMVoltageA . . . . . . . . . . .  MEMBER   -----  ARRAY    0014H  4
  ucCOMMVoltageB . . . . . . . . . . .  MEMBER   -----  ARRAY    0018H  4
  ucCOMMVoltageC . . . . . . . . . . .  MEMBER   -----  ARRAY    001CH  4
  ucCurrent. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0020H  4
  ucCurrentA . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0024H  4
  ucCurrentB . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0028H  4
  ucCurrentC . . . . . . . . . . . . .  MEMBER   -----  ARRAY    002CH  4
  ucCOMMCurrent. . . . . . . . . . . .  MEMBER   -----  ARRAY    0030H  4
  ucCOMMCurrentA . . . . . . . . . . .  MEMBER   -----  ARRAY    0034H  4
  ucCOMMCurrentB . . . . . . . . . . .  MEMBER   -----  ARRAY    0038H  4
  ucCOMMCurrentC . . . . . . . . . . .  MEMBER   -----  ARRAY    003CH  4
  ucPower. . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0040H  4
  ucPowerA . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0044H  4
  ucPowerB . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0048H  4
  ucPowerC . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    004CH  4
  ucCOMMPower. . . . . . . . . . . . .  MEMBER   -----  ARRAY    0050H  4
  ucCOMMPowerA . . . . . . . . . . . .  MEMBER   -----  ARRAY    0054H  4
  ucCOMMPowerB . . . . . . . . . . . .  MEMBER   -----  ARRAY    0058H  4
  ucCOMMPowerC . . . . . . . . . . . .  MEMBER   -----  ARRAY    005CH  4
  ucFactory. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0060H  4
  ucFactoryA . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0064H  4
  ucFactoryB . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0068H  4
  ucFactoryC . . . . . . . . . . . . .  MEMBER   -----  ARRAY    006CH  4
  ucCOMMFactory. . . . . . . . . . . .  MEMBER   -----  ARRAY    0070H  4
  ucCOMMFactoryA . . . . . . . . . . .  MEMBER   -----  ARRAY    0074H  4
  ucCOMMFactoryB . . . . . . . . . . .  MEMBER   -----  ARRAY    0078H  4
  ucCOMMFactoryC . . . . . . . . . . .  MEMBER   -----  ARRAY    007CH  4
  ucFrequency. . . . . . . . . . . . .  MEMBER   -----  ARRAY    0080H  4
  ucMeterConst . . . . . . . . . . . .  MEMBER   -----  ARRAY    0084H  3
TL0. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   008AH  1
EX4. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00A8H  1
TL1. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   008BH  1
FLASHCON . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A7H  1
LIB_E2P_Money_Para . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
TL2. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00CCH  1
LIB_E2P_ENERGY_DECPULSE_BK . . . . . .  E_CONST  -----  U_CHAR   -----  1
LIB_E2P_AvailTimer . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
RS0. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D3H  1
ADCDH. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C5H  1
_BleDrv_BleParaChk . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  v_ucMode . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  V_ucResult . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
LIB_E2P_Price. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_AVAIL_Type. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  41
  us_IDAvailTimer. . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  ucBackMonFlag. . . . . . . . . . . .  MEMBER   -----  U_CHAR   0002H  1
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0003H  2
  ulAutRemainingTime . . . . . . . . .  MEMBER   -----  U_LONG   0005H  4
  ucRechangeMoney. . . . . . . . . . .  MEMBER   -----  ARRAY    0009H  4
  ucBuybeforeMoney . . . . . . . . . .  MEMBER   -----  ARRAY    000DH  4
  ucbeforeFwEnergy . . . . . . . . . .  MEMBER   -----  ARRAY    0011H  4
  ucbeforeBkEnergy . . . . . . . . . .  MEMBER   -----  ARRAY    0015H  4
  ucE2Key. . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0019H  16
GU_BoolWordVariable. . . . . . . . . .  TYPEDEF  -----  UNION    -----  2
  BYTE . . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  2
  BIT. . . . . . . . . . . . . . . . .  MEMBER   -----  STRUCT   0000H  2
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 27  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


TR0. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      008CH  1
RS1. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D4H  1
PWMCON . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   009FH  1
_BleDrv_SetBleTPL. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  p_ucDataBuf. . . . . . . . . . . . .  AUTO     XDATA  PTR      0000H  3
  V_ucLen. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0003H  1
  V_ucTempBuff . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0004H  5
TR1. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      008EH  1
char8. . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
TR2. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00CAH  1
_LibPub_HEXtoAscii . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
int8_t . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
ADCDL. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C4H  1
ADT. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C2H  1
LIB_E2P_INDEX. . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
GStr_PRICE_Type. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  14
  ucaPrice . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  ucaPurchaseMoneyAll. . . . . . . . .  MEMBER   -----  ARRAY    0004H  4
  ucPurchaseTimes. . . . . . . . . . .  MEMBER   -----  ARRAY    0008H  4
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    000CH  2
DPH. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0083H  1
_BleDrv_GetBleName . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  p_ucDataBuf. . . . . . . . . . . . .  AUTO     XDATA  PTR      0000H  3
  V_ucReasult. . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0003H  1
  V_ucTempBuff . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0004H  25
GStr_Flag. . . . . . . . . . . . . . .  EXTERN   XDATA  STRUCT   -----  16
_BleDrv_GetBlePara . . . . . . . . . .  STATIC   CODE   PROC     0000H  -----
  V_ucCmdIndex . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  p_ucDataBuf. . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
  v_ucLen. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
  V_ucTempBuff . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0005H  100
  V_ucResult . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0069H  1
DPL. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0082H  1
_ApiPwOn_UART_SendEn . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
SBUF1. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D9H  1
COMM_BLE_EADV. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LIB_E2P_FUN_CONFIG . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
EXEN2. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00CBH  1
SBUF2. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F9H  1
BleDrv_BleStatuChk . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  V_ucBleStatus. . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  p_ucDataBuf. . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0001H  100
  i. . . . . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0065H  1
LIB_E2P_ENERGY_DECPULSE_FW . . . . . .  E_CONST  -----  U_CHAR   -----  1
SM11_RXOV1 . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00DEH  1
PADCL. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00BEH  1
REN. . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      009CH  1
SCON1. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D8H  1
STATUS . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
LCDCON1. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D1H  1
ADCON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C1H  1
SCON2. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F8H  1
TCON1. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   008FH  1
LIB_E2P_EventValidPiont. . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LIB_E2P_ENRGY. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LCDCON2. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D2H  1
EDTAH. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0092H  1
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 28  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


T2MOD. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C9H  1
T2CON. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C8H  1
C_StrBle_MAP_TAB . . . . . . . . . . .  PUBLIC   CODE   ARRAY    0013H  49
_LibPub_CalSum . . . . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
GStr_FUN_CONFIG_Type . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  16
  ucFunCurrentVal. . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  ucFunMeterConst. . . . . . . . . . .  MEMBER   -----  U_CHAR   0001H  1
  ucRes. . . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0002H  12
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    000EH  2
Str_BleData_MAP. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  7
  ucIndex. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  ucaDataId. . . . . . . . . . . . . .  MEMBER   -----  U_LONG   0001H  4
  IsWrite. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  ucaDataLen . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
GStr_EventParaData . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  5
  V_usEventID. . . . . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  V_usEventAddr. . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  V_ucEventLenth . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
LIB_E2P_Money. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_LibPub_MemCopyBytes . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
EDTAL. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0094H  1
_BleDrv_SetBlePara . . . . . . . . . .  STATIC   CODE   PROC     0000H  -----
  V_ucCmdIndex . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  p_ucDataBuf. . . . . . . . . . . . .  AUTO     XDATA  PTR      0001H  3
  v_ucLen. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0004H  1
  V_ucTempBuff . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0005H  100
  P_ucDataEcho . . . . . . . . . . . .  AUTO     XDATA  PTR      0069H  3
  V_ucResult . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   006CH  1
_BleDrv_GetBleMac. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  p_ucDataBuf. . . . . . . . . . . . .  * REG *  DATA   PTR      0001H  3
GStr_EEPROM_MAP. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  8
  ucE2pAddressIndex. . . . . . . . . .  MEMBER   -----  U_INT    0000H  2
  usE2pAddress . . . . . . . . . . . .  MEMBER   -----  U_INT    0002H  2
  ucE2pSize. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0004H  1
  ucE2pLen . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0005H  1
  ucIsCRC. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0006H  1
  ucIsBak. . . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0007H  1
EDTAM. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0093H  1
TK0DIFH. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00BCH  1
SADEN. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   009BH  1
wchar_t. . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
LIB_E2P_METER_INFO . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
_LibPub_ReadDataFromE2prom . . . . . .  EXTERN   CODE   PROC     -----  -----
TK1DIFH. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00BEH  1
PBANK. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00B6H  1
GStr_EventValidPiont_Type. . . . . . .  TYPEDEF  -----  STRUCT   -----  8
  uc_Point . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  6
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0006H  2
TK2DIFH. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A5H  1
_BleDrv_CommGetBlePara . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  v_ucComIndex . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0007H  1
  v_ucLen. . . . . . . . . . . . . . .  * REG *  DATA   U_CHAR   0005H  1
  p_ucDataBuf. . . . . . . . . . . . .  * REG *  DATA   PTR      0001H  3
EADTP. . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00AEH  1
SADDR. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   009AH  1
BleDrv_InitPwn . . . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
TK0DIFL. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00CFH  1
C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 29  

NAME                                    CLASS   MSPACE  TYPE    OFFSET  SIZE
====                                    =====   ======  ====    ======  ====


LIB_E2P_ENERGY_DECPULSE_WS . . . . . .  E_CONST  -----  U_CHAR   -----  1
GStr_MONEY_Type. . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  14
  ucaRemainMoney . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  6
  ucaTickMoney . . . . . . . . . . . .  MEMBER   -----  ARRAY    0006H  6
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    000CH  2
TK1DIFL. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00BDH  1
TK2DIFL. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00BFH  1
P7816L . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00BAH  1
LPDCON1. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C6H  1
LIB_E2P_EMU_UIPKms_BAK . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LPDCON2. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00C7H  1
MAX_BLE_INDEX. . . . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
LIB_E2P_SecretKey. . . . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
F0 . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D5H  1
IRDAT. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00AEH  1
EMU_Read_TRIPCAL_TAB_Type. . . . . . .  TYPEDEF  -----  STRUCT   -----  5
  ucCommDI1. . . . . . . . . . . . . .  MEMBER   -----  U_CHAR   0000H  1
  ucEmuAddr. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0001H  4
_LibPub_MemExchangeBytes . . . . . . .  EXTERN   CODE   PROC     -----  -----
F1 . . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00D1H  1
EMUIE. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0096H  1
SFINE. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   009EH  1
XPAGE. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F7H  1
Gstr_VirtualEsam . . . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  64
  ucTempKey. . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  16
  ucDisKey . . . . . . . . . . . . . .  MEMBER   -----  ARRAY    0010H  16
  ucComplexKey . . . . . . . . . . . .  MEMBER   -----  ARRAY    0020H  16
  ucRs485RandNum . . . . . . . . . . .  MEMBER   -----  ARRAY    0030H  8
  ucRs485RandNum2. . . . . . . . . . .  MEMBER   -----  ARRAY    0038H  8
GStr_MONEY_PARA_Type . . . . . . . . .  TYPEDEF  -----  STRUCT   -----  25
  ucaAlarmMoneyL1. . . . . . . . . . .  MEMBER   -----  ARRAY    0000H  4
  ucaAlarmMoneyL2. . . . . . . . . . .  MEMBER   -----  ARRAY    0004H  4
  ucaMaxMoneyLimit . . . . . . . . . .  MEMBER   -----  ARRAY    0008H  4
  ucaTickMoneyLimit. . . . . . . . . .  MEMBER   -----  ARRAY    000CH  4
  ucaAllowcloseMoney . . . . . . . . .  MEMBER   -----  ARRAY    0010H  4
  ucaOverLoadVal . . . . . . . . . . .  MEMBER   -----  ARRAY    0014H  3
  usCRC16. . . . . . . . . . . . . . .  MEMBER   -----  U_INT    0017H  2
INT8S. . . . . . . . . . . . . . . . .  TYPEDEF  -----  CHAR     -----  1
EMUIF. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   0097H  1
_BleDrv_SetBleMac. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  p_ucDataBuf. . . . . . . . . . . . .  * REG *  DATA   PTR      0001H  3
BleDrv_GetBleStat. . . . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
API_COMM_STATUS_FRAME_OK . . . . . . .  E_CONST  -----  U_CHAR   -----  1
INT8U. . . . . . . . . . . . . . . . .  TYPEDEF  -----  U_CHAR   -----  1
PSW. . . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00D0H  1
_BleDrv_CommSetBlePara . . . . . . . .  PUBLIC   CODE   PROC     0000H  -----
  v_ucComIndex . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0000H  1
  v_ucLen. . . . . . . . . . . . . . .  AUTO     XDATA  U_CHAR   0001H  1
  p_ucDataBuf. . . . . . . . . . . . .  AUTO     XDATA  PTR      0002H  3
  V_ucTempBuff . . . . . . . . . . . .  AUTO     XDATA  ARRAY    0005H  35
_LibPub_MemSetBytes. . . . . . . . . .  EXTERN   CODE   PROC     -----  -----
FP32 . . . . . . . . . . . . . . . . .  TYPEDEF  -----  FLOAT    -----  4
uint32_t . . . . . . . . . . . . . . .  TYPEDEF  -----  U_LONG   -----  4
API_COMM_STATUS_FRAME. . . . . . . . .  E_CONST  -----  U_CHAR   -----  1
RB81 . . . . . . . . . . . . . . . . .  ABSBIT   -----  BIT      00DAH  1
SPDAT. . . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00A3H  1
IB_CON1. . . . . . . . . . . . . . . .  SFR      DATA   U_CHAR   00F2H  1

C51 COMPILER V9.54   BLEDRV                                                                11/18/2021 18:54:14 PAGE 30  


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   2202    ----
   CONSTANT SIZE    =    598    ----
   XDATA SIZE       =   ----     584
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
